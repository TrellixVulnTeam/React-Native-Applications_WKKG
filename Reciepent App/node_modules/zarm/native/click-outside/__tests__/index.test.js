var _interopRequireDefault=require("@babel/runtime/helpers/interopRequireDefault");var _react=_interopRequireDefault(require("react"));var _enzyme=require("enzyme");var _enzymeToJson=_interopRequireDefault(require("enzyme-to-json"));var _index=_interopRequireDefault(require("../index"));var _events=_interopRequireDefault(require("../../utils/events"));var _this=this,_jsxFileName="/Users/linji/Documents/workspace/zarm/zarm/components/click-outside/__tests__/index.test.tsx";describe('ClickOutside',function(){afterEach(function(){jest.restoreAllMocks();});it('renders correctly',function(){var wrapper=(0,_enzyme.render)(_react.default.createElement(_index.default,{onClickOutside:function onClickOutside(){},__self:_this,__source:{fileName:_jsxFileName,lineNumber:13,columnNumber:7}},_react.default.createElement("div",{__self:_this,__source:{fileName:_jsxFileName,lineNumber:14,columnNumber:9}},"test")));expect((0,_enzymeToJson.default)(wrapper)).toMatchSnapshot();});it('should pass standard HTML attributes to root node',function(){var wrapper=(0,_enzyme.mount)(_react.default.createElement(_index.default,{id:"test",__self:_this,__source:{fileName:_jsxFileName,lineNumber:22,columnNumber:27}}));expect(wrapper.getDOMNode().id).toEqual('test');});it('should not call action on click outside the component when disabled',function(){var onClickOutside=jest.fn();var clickEvent=new MouseEvent('click',{bubbles:true});var wrapper=(0,_enzyme.mount)(_react.default.createElement(_index.default,{disabled:true,onClickOutside:onClickOutside,__self:_this,__source:{fileName:_jsxFileName,lineNumber:31,columnNumber:7}},_react.default.createElement("div",{id:"test",__self:_this,__source:{fileName:_jsxFileName,lineNumber:32,columnNumber:9}},"test disabled")));wrapper.find('#test').getDOMNode().dispatchEvent(clickEvent);expect(onClickOutside).not.toHaveBeenCalled();});it('should bind click and touchend event handler on document when component did mount',function(){var eventsOnSpy=jest.spyOn(_events.default,'on').mockImplementation();(0,_enzyme.shallow)(_react.default.createElement(_index.default,{__self:_this,__source:{fileName:_jsxFileName,lineNumber:41,columnNumber:13}}));expect(eventsOnSpy).toBeCalledWith(document,'click',expect.any(Function));expect(eventsOnSpy).toBeCalledWith(document,'touchend',expect.any(Function));expect(eventsOnSpy).toBeCalledTimes(2);});it('should unbind event handler from document when disabled and component did update',function(){var eventsOnSpy=jest.spyOn(_events.default,'on').mockImplementation();var eventsOffSpy=jest.spyOn(_events.default,'off').mockImplementation();var wrapper=(0,_enzyme.shallow)(_react.default.createElement(_index.default,{__self:_this,__source:{fileName:_jsxFileName,lineNumber:50,columnNumber:29}}));expect(eventsOnSpy).toBeCalledWith(document,'click',expect.any(Function));expect(eventsOnSpy).toBeCalledWith(document,'touchend',expect.any(Function));expect(eventsOnSpy).toBeCalledTimes(2);wrapper.setProps({disabled:true});expect(eventsOffSpy).toBeCalledWith(document,'click',expect.any(Function));expect(eventsOffSpy).toBeCalledWith(document,'touchend',expect.any(Function));expect(eventsOffSpy).toBeCalledTimes(2);});it('should bind event handler when enabled and component did update',function(){var eventsOnSpy=jest.spyOn(_events.default,'on').mockImplementation();var wrapper=(0,_enzyme.shallow)(_react.default.createElement(_index.default,{disabled:true,__self:_this,__source:{fileName:_jsxFileName,lineNumber:62,columnNumber:29}}));expect(eventsOnSpy).not.toBeCalled();wrapper.setProps({disabled:false});expect(eventsOnSpy).toBeCalledWith(document,'click',expect.any(Function));expect(eventsOnSpy).toBeCalledWith(document,'touchend',expect.any(Function));expect(eventsOnSpy).toBeCalledTimes(2);});it('should unbind event handler when component will unmount',function(){var eventsOffSpy=jest.spyOn(_events.default,'off').mockImplementation();var wrapper=(0,_enzyme.shallow)(_react.default.createElement(_index.default,{__self:_this,__source:{fileName:_jsxFileName,lineNumber:72,columnNumber:29}}));wrapper.unmount();expect(eventsOffSpy).toBeCalledWith(document,'click',expect.any(Function));expect(eventsOffSpy).toBeCalledWith(document,'touchend',expect.any(Function));expect(eventsOffSpy).toBeCalledTimes(2);});it('should not call action when user click if isTouch is true',function(){var mOnClickOutside=jest.fn();var touchEndEvent=new TouchEvent('touchend');var clickEvent=new MouseEvent('click');(0,_enzyme.shallow)(_react.default.createElement(_index.default,{onClickOutside:mOnClickOutside,__self:_this,__source:{fileName:_jsxFileName,lineNumber:83,columnNumber:13}}));document.dispatchEvent(touchEndEvent);document.dispatchEvent(clickEvent);expect(mOnClickOutside).not.toBeCalled();});it('should not call action on click inside the component',function(){var mOnClickOutside=jest.fn();var outerNode=document.createElement('div');document.body.appendChild(outerNode);var wrapper=(0,_enzyme.mount)(_react.default.createElement(_index.default,{onClickOutside:mOnClickOutside,__self:_this,__source:{fileName:_jsxFileName,lineNumber:94,columnNumber:7}},_react.default.createElement("div",{id:"test",__self:_this,__source:{fileName:_jsxFileName,lineNumber:95,columnNumber:9}},"test")),{attachTo:outerNode});var clickEvent=new MouseEvent('click',{bubbles:true});wrapper.find('#test').getDOMNode().dispatchEvent(clickEvent);expect(mOnClickOutside).not.toBeCalled();});});